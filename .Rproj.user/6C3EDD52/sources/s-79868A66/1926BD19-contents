# mle and score for exponential distribution with rate
# parameter lambda
mle <- function(y){length(y)/sum(y)}
score <- function(lambda,y){length(y)/lambda-sum(y)}
 
# fundamental parameter
n <- 10 # size of data sets
nsim <- 10000 # number of simulated data sets
lambda <- 1.0 # true parameter
fisherInfo <- n/(lambda^2) # Fisher information

mles <- numeric(nsim)
scores <- numeric(nsim)


for(i in 1:nsim){
  y <- rexp(n=n,rate=lambda) # simulate data set
  mles[i] <- mle(y)-lambda # MLE minus true parameter
  scores[i] <- score(lambda,y) # score at true parameter
}

# histogram of scores (evalutated at true par) and associated
# asymptotic Normal result (N(0,Fisher info))
par(mfrow=c(2,1))
hist(scores,probability = TRUE,breaks=30)
grd <- seq(from=min(scores),to=max(scores),length.out = 100000)
lines(grd,dnorm(grd,mean=0,sd=sqrt(fisherInfo)),col="red")

# histogram of MLEs (minus true par) and assocated
# asymptotic normal result (N(0,inverse Fisher info))
hist(mles,probability = TRUE,breaks=30)
grd <- seq(from=min(mles),to=max(mles),length.out = 100000)
lines(grd,dnorm(grd,mean=0,sd=sqrt(1/fisherInfo)),col="red")


